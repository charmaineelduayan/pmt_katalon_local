1
00:00:00,404 --> 00:00:00,414
1. try

2
00:00:00,421 --> 00:00:06,484
1. utils.openBrowserAndNavigateToPMT()

3
00:00:06,503 --> 00:00:06,526
5. EXCEL_PATH = "./Data Files/TestData.xlsx"

4
00:00:06,545 --> 00:00:06,555
9. TAB = "GiftCards"

5
00:00:06,556 --> 00:00:06,596
13. driver = getWebDriver()

6
00:00:06,597 --> 00:00:09,216
17. utils.goToGiftCards()

7
00:00:09,216 --> 00:00:09,987
21. utils.selectEnvironment(ENV)

8
00:00:09,988 --> 00:00:10,221
25. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

9
00:00:10,221 --> 00:00:10,761
29. testdata = getdata.fromExcel(EXCEL_PATH, "GiftCards")

10
00:00:10,762 --> 00:00:10,765
33. for ([i = 0, i < testdata.size(), (i++)])

11
00:00:10,766 --> 00:00:15,791
1. delay(5)

12
00:00:15,792 --> 00:00:15,819
5. sendRequestTextBox.clear()

13
00:00:15,820 --> 00:00:15,825
9. cardNumber = testdata["cardNumber"][i]

14
00:00:15,825 --> 00:00:15,832
13. CNumber = cardNumber.replaceAll("\.0$", "")

15
00:00:15,832 --> 00:00:15,836
17. expirationMonth = testdata["expirationMonth"][i]

16
00:00:15,837 --> 00:00:15,840
21. xMonth = expirationMonth.replaceAll("\.0$", "")

17
00:00:15,841 --> 00:00:15,844
25. expirationYear = testdata["expirationYear"][i]

18
00:00:15,844 --> 00:00:15,847
29. xYear = expirationYear.replaceAll("\.0$", "")

19
00:00:15,847 --> 00:00:15,849
33. securityCode = testdata["securityCode"][i]

20
00:00:15,850 --> 00:00:15,852
37. SC = securityCode.replaceAll("\.0$", "")

21
00:00:15,852 --> 00:00:15,892
41. request = {
			"cardNumber": "$cardNumber",
			"expirationMonth": "$expirationMonth",
			"expirationYear": "$expirationYear",
			"securityCode": "$securityCode"
			}

22
00:00:15,893 --> 00:00:15,912
45. restRequest = JsonSlurper().parseText(request)

23
00:00:15,912 --> 00:00:15,942
49. prettyJson = JsonBuilder(restRequest).toPrettyString()

24
00:00:15,942 --> 00:00:15,946
53. println(prettyJson)

25
00:00:15,947 --> 00:00:16,252
57. sendRequestTextBox.sendKeys(prettyJson)

26
00:00:16,253 --> 00:00:16,884
61. utils.clickSendButton()

27
00:00:16,893 --> 00:00:19,148
65. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

28
00:00:19,149 --> 00:00:22,156
69. delay(3)

29
00:00:22,157 --> 00:00:22,402
73. response = utils.getResponse()

30
00:00:22,403 --> 00:00:22,406
77. println(response)

31
00:00:22,406 --> 00:00:22,409
81. validation1 = testdata["ContainsValidation"][i]

32
00:00:22,409 --> 00:00:22,411
85. println(validation1)

33
00:00:22,412 --> 00:00:22,415
89. validation2 = testdata["NotContainsValidation"][i]

34
00:00:22,415 --> 00:00:22,418
93. println(validation2)

35
00:00:22,419 --> 00:00:22,422
97. println(testdata["TCNumber"][i])

36
00:00:22,422 --> 00:00:22,437
101. assert response.contains(validation1)

37
00:00:22,437 --> 00:00:22,447
105. assert response.contains(validation2) == false

38
00:00:22,448 --> 00:00:27,451
1. delay(5)

39
00:00:27,452 --> 00:00:27,511
5. sendRequestTextBox.clear()

40
00:00:27,511 --> 00:00:27,512
9. cardNumber = testdata["cardNumber"][i]

41
00:00:27,513 --> 00:00:27,515
13. CNumber = cardNumber.replaceAll("\.0$", "")

42
00:00:27,515 --> 00:00:27,517
17. expirationMonth = testdata["expirationMonth"][i]

43
00:00:27,517 --> 00:00:27,519
21. xMonth = expirationMonth.replaceAll("\.0$", "")

44
00:00:27,519 --> 00:00:27,521
25. expirationYear = testdata["expirationYear"][i]

45
00:00:27,522 --> 00:00:27,523
29. xYear = expirationYear.replaceAll("\.0$", "")

46
00:00:27,524 --> 00:00:27,525
33. securityCode = testdata["securityCode"][i]

47
00:00:27,526 --> 00:00:27,527
37. SC = securityCode.replaceAll("\.0$", "")

48
00:00:27,528 --> 00:00:27,530
41. request = {
			"cardNumber": "$cardNumber",
			"expirationMonth": "$expirationMonth",
			"expirationYear": "$expirationYear",
			"securityCode": "$securityCode"
			}

49
00:00:27,530 --> 00:00:27,532
45. restRequest = JsonSlurper().parseText(request)

50
00:00:27,532 --> 00:00:27,535
49. prettyJson = JsonBuilder(restRequest).toPrettyString()

51
00:00:27,536 --> 00:00:27,538
53. println(prettyJson)

52
00:00:27,538 --> 00:00:27,776
57. sendRequestTextBox.sendKeys(prettyJson)

53
00:00:27,777 --> 00:00:28,108
61. utils.clickSendButton()

54
00:00:28,109 --> 00:00:29,900
65. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

55
00:00:29,901 --> 00:00:32,908
69. delay(3)

56
00:00:32,909 --> 00:00:33,148
73. response = utils.getResponse()

57
00:00:33,149 --> 00:00:33,150
77. println(response)

58
00:00:33,151 --> 00:00:33,152
81. validation1 = testdata["ContainsValidation"][i]

59
00:00:33,153 --> 00:00:33,154
85. println(validation1)

60
00:00:33,154 --> 00:00:33,156
89. validation2 = testdata["NotContainsValidation"][i]

61
00:00:33,156 --> 00:00:33,157
93. println(validation2)

62
00:00:33,158 --> 00:00:33,160
97. println(testdata["TCNumber"][i])

63
00:00:33,160 --> 00:00:33,162
101. assert response.contains(validation1)

64
00:00:33,162 --> 00:00:33,163
105. assert response.contains(validation2) == false

65
00:00:33,163 --> 00:00:38,172
1. delay(5)

66
00:00:38,173 --> 00:00:38,220
5. sendRequestTextBox.clear()

67
00:00:38,221 --> 00:00:38,222
9. cardNumber = testdata["cardNumber"][i]

68
00:00:38,222 --> 00:00:38,224
13. CNumber = cardNumber.replaceAll("\.0$", "")

69
00:00:38,224 --> 00:00:38,226
17. expirationMonth = testdata["expirationMonth"][i]

70
00:00:38,226 --> 00:00:38,227
21. xMonth = expirationMonth.replaceAll("\.0$", "")

71
00:00:38,228 --> 00:00:38,229
25. expirationYear = testdata["expirationYear"][i]

72
00:00:38,229 --> 00:00:38,230
29. xYear = expirationYear.replaceAll("\.0$", "")

73
00:00:38,230 --> 00:00:38,231
33. securityCode = testdata["securityCode"][i]

74
00:00:38,232 --> 00:00:38,233
37. SC = securityCode.replaceAll("\.0$", "")

75
00:00:38,234 --> 00:00:38,235
41. request = {
			"cardNumber": "$cardNumber",
			"expirationMonth": "$expirationMonth",
			"expirationYear": "$expirationYear",
			"securityCode": "$securityCode"
			}

76
00:00:38,236 --> 00:00:38,237
45. restRequest = JsonSlurper().parseText(request)

77
00:00:38,237 --> 00:00:38,239
49. prettyJson = JsonBuilder(restRequest).toPrettyString()

78
00:00:38,239 --> 00:00:38,240
53. println(prettyJson)

79
00:00:38,241 --> 00:00:38,424
57. sendRequestTextBox.sendKeys(prettyJson)

80
00:00:38,425 --> 00:00:38,715
61. utils.clickSendButton()

81
00:00:38,715 --> 00:00:40,223
65. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

82
00:00:40,223 --> 00:00:43,229
69. delay(3)

83
00:00:43,230 --> 00:00:43,458
73. response = utils.getResponse()

84
00:00:43,458 --> 00:00:43,459
77. println(response)

85
00:00:43,460 --> 00:00:43,460
81. validation1 = testdata["ContainsValidation"][i]

86
00:00:43,460 --> 00:00:43,461
85. println(validation1)

87
00:00:43,461 --> 00:00:43,462
89. validation2 = testdata["NotContainsValidation"][i]

88
00:00:43,462 --> 00:00:43,462
93. println(validation2)

89
00:00:43,463 --> 00:00:43,463
97. println(testdata["TCNumber"][i])

90
00:00:43,463 --> 00:00:43,464
101. assert response.contains(validation1)

91
00:00:43,464 --> 00:00:43,464
105. assert response.contains(validation2) == false

92
00:00:43,465 --> 00:00:48,472
1. delay(5)

93
00:00:48,473 --> 00:00:48,519
5. sendRequestTextBox.clear()

94
00:00:48,519 --> 00:00:48,520
9. cardNumber = testdata["cardNumber"][i]

95
00:00:48,520 --> 00:00:48,521
13. CNumber = cardNumber.replaceAll("\.0$", "")

96
00:00:48,521 --> 00:00:48,522
17. expirationMonth = testdata["expirationMonth"][i]

97
00:00:48,522 --> 00:00:48,523
21. xMonth = expirationMonth.replaceAll("\.0$", "")

98
00:00:48,523 --> 00:00:48,524
25. expirationYear = testdata["expirationYear"][i]

99
00:00:48,525 --> 00:00:48,526
29. xYear = expirationYear.replaceAll("\.0$", "")

100
00:00:48,526 --> 00:00:48,527
33. securityCode = testdata["securityCode"][i]

101
00:00:48,527 --> 00:00:48,528
37. SC = securityCode.replaceAll("\.0$", "")

102
00:00:48,528 --> 00:00:48,529
41. request = {
			"cardNumber": "$cardNumber",
			"expirationMonth": "$expirationMonth",
			"expirationYear": "$expirationYear",
			"securityCode": "$securityCode"
			}

103
00:00:48,529 --> 00:00:48,530
45. restRequest = JsonSlurper().parseText(request)

104
00:00:48,531 --> 00:00:48,532
49. prettyJson = JsonBuilder(restRequest).toPrettyString()

105
00:00:48,533 --> 00:00:48,534
53. println(prettyJson)

106
00:00:48,534 --> 00:00:48,718
57. sendRequestTextBox.sendKeys(prettyJson)

107
00:00:48,719 --> 00:00:49,016
61. utils.clickSendButton()

108
00:00:49,016 --> 00:00:50,456
65. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

109
00:00:50,456 --> 00:00:53,462
69. delay(3)

110
00:00:53,463 --> 00:00:53,696
73. response = utils.getResponse()

111
00:00:53,696 --> 00:00:53,697
77. println(response)

112
00:00:53,697 --> 00:00:53,698
81. validation1 = testdata["ContainsValidation"][i]

113
00:00:53,698 --> 00:00:53,699
85. println(validation1)

114
00:00:53,699 --> 00:00:53,700
89. validation2 = testdata["NotContainsValidation"][i]

115
00:00:53,700 --> 00:00:53,701
93. println(validation2)

116
00:00:53,701 --> 00:00:53,701
97. println(testdata["TCNumber"][i])

117
00:00:53,702 --> 00:00:53,702
101. assert response.contains(validation1)

118
00:00:53,702 --> 00:00:53,703
105. assert response.contains(validation2) == false

119
00:00:53,703 --> 00:00:58,707
1. delay(5)

120
00:00:58,707 --> 00:00:58,744
5. sendRequestTextBox.clear()

121
00:00:58,744 --> 00:00:58,746
9. cardNumber = testdata["cardNumber"][i]

122
00:00:58,746 --> 00:00:58,747
13. CNumber = cardNumber.replaceAll("\.0$", "")

123
00:00:58,747 --> 00:00:58,748
17. expirationMonth = testdata["expirationMonth"][i]

124
00:00:58,748 --> 00:00:58,749
21. xMonth = expirationMonth.replaceAll("\.0$", "")

125
00:00:58,750 --> 00:00:58,750
25. expirationYear = testdata["expirationYear"][i]

126
00:00:58,751 --> 00:00:58,752
29. xYear = expirationYear.replaceAll("\.0$", "")

127
00:00:58,752 --> 00:00:58,754
33. securityCode = testdata["securityCode"][i]

128
00:00:58,754 --> 00:00:58,755
37. SC = securityCode.replaceAll("\.0$", "")

129
00:00:58,755 --> 00:00:58,756
41. request = {
			"cardNumber": "$cardNumber",
			"expirationMonth": "$expirationMonth",
			"expirationYear": "$expirationYear",
			"securityCode": "$securityCode"
			}

130
00:00:58,757 --> 00:00:58,757
45. restRequest = JsonSlurper().parseText(request)

131
00:00:58,758 --> 00:00:58,759
49. prettyJson = JsonBuilder(restRequest).toPrettyString()

132
00:00:58,759 --> 00:00:58,760
53. println(prettyJson)

133
00:00:58,760 --> 00:00:58,916
57. sendRequestTextBox.sendKeys(prettyJson)

134
00:00:58,916 --> 00:00:59,194
61. utils.clickSendButton()

135
00:00:59,194 --> 00:01:00,640
65. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

136
00:01:00,641 --> 00:01:03,645
69. delay(3)

137
00:01:03,646 --> 00:01:03,870
73. response = utils.getResponse()

138
00:01:03,871 --> 00:01:03,871
77. println(response)

139
00:01:03,872 --> 00:01:03,872
81. validation1 = testdata["ContainsValidation"][i]

140
00:01:03,872 --> 00:01:03,873
85. println(validation1)

141
00:01:03,873 --> 00:01:03,873
89. validation2 = testdata["NotContainsValidation"][i]

142
00:01:03,874 --> 00:01:03,874
93. println(validation2)

143
00:01:03,875 --> 00:01:03,875
97. println(testdata["TCNumber"][i])

144
00:01:03,875 --> 00:01:03,876
101. assert response.contains(validation1)

145
00:01:03,876 --> 00:01:03,879
105. assert response.contains(validation2) == false

146
00:01:03,879 --> 00:01:06,030
1. utils.closeBrowser()

