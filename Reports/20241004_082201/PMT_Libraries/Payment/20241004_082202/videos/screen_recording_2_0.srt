1
00:00:00,521 --> 00:00:07,494
1. utils.openBrowserAndNavigateToPMT()

2
00:00:07,557 --> 00:00:07,603
5. try

3
00:00:07,660 --> 00:00:07,839
1. callTestCase(findTestCase("Re-Usable Script/Payment_AuthorizePayment"), [:], STOP_ON_FAILURE)

4
00:00:07,843 --> 00:00:07,882
1. driver = getWebDriver()

5
00:00:07,902 --> 00:00:09,467
5. utils.goToPayments()

6
00:00:09,468 --> 00:00:09,994
9. clickAuthorizePayment = xpath("//a[normalize-space()='Authorize payment']")).click()

7
00:00:10,013 --> 00:00:10,017
13. EXCEL_PATH = "./Data Files/TestData.xlsx"

8
00:00:10,018 --> 00:00:10,022
17. TAB = "Payment_Authorize"

9
00:00:10,022 --> 00:00:11,161
21. utils.selectEnvironment(ENV)

10
00:00:11,162 --> 00:00:11,354
25. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

11
00:00:11,360 --> 00:00:11,362
29. for ([TestScenarioNumber = 0, TestScenarioNumber < testdata.size(), (TestScenarioNumber++)])

12
00:00:11,363 --> 00:00:11,386
1. println(testdata.size())

13
00:00:11,386 --> 00:00:33,031
5. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

14
00:00:33,032 --> 00:00:33,034
9. println(getBookingData["BookingId"])

15
00:00:33,035 --> 00:00:33,038
13. println(getBookingData["BookingAccessToken"])

16
00:00:33,039 --> 00:00:38,080
17. delay(5)

17
00:00:38,101 --> 00:00:38,123
21. bookingIdCol = testdata["bookingId"][TestScenarioNumber]

18
00:00:38,143 --> 00:00:38,165
25. BookingId = getBookingData["BookingId"]

19
00:00:38,166 --> 00:00:38,187
29. replaceBookingId = bookingIdCol.replace("BookingId", BookingId)

20
00:00:38,188 --> 00:00:38,191
33. println(replaceBookingId)

21
00:00:38,191 --> 00:00:38,193
37. passengerIdCol = testdata["passengerId"][TestScenarioNumber]

22
00:00:38,194 --> 00:00:38,197
41. PassengerId = getBookingData["PassengerId"]

23
00:00:38,197 --> 00:00:38,231
45. replacePassengerId = passengerIdCol.replace("PassengerId", PassengerId)

24
00:00:38,232 --> 00:00:38,235
2. println(An unexpected error occurred: $e.message)

25
00:00:38,236 --> 00:00:38,245
6. e.printStackTrace()

26
00:00:38,245 --> 00:00:40,525
1. utils.closeBrowser()

