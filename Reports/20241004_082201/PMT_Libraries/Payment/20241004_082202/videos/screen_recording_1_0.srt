1
00:00:01,445 --> 00:00:16,578
1. utils.openBrowserAndNavigateToPMT()

2
00:00:16,599 --> 00:00:16,641
5. try

3
00:00:16,674 --> 00:00:16,698
1. EXCEL_PATH = "./Data Files/TestData.xlsx"

4
00:00:16,719 --> 00:00:16,726
5. TAB = "Payment_Capture"

5
00:00:16,727 --> 00:00:18,714
9. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

6
00:00:18,727 --> 00:00:18,736
13. for ([TestScenarioNumber = 0, TestScenarioNumber < testdata.size(), (TestScenarioNumber++)])

7
00:00:18,737 --> 00:00:18,745
1. println(testdata.size())

8
00:00:18,746 --> 00:00:19,466
5. callTestCase(findTestCase("Re-Usable Script/Payment_AuthorizePayment"), [:], STOP_ON_FAILURE)

9
00:00:19,467 --> 00:00:19,491
1. driver = getWebDriver()

10
00:00:19,492 --> 00:00:20,910
5. utils.goToPayments()

11
00:00:20,911 --> 00:00:21,410
9. clickAuthorizePayment = xpath("//a[normalize-space()='Authorize payment']")).click()

12
00:00:21,411 --> 00:00:21,414
13. EXCEL_PATH = "./Data Files/TestData.xlsx"

13
00:00:21,415 --> 00:00:21,419
17. TAB = "Payment_Authorize"

14
00:00:21,420 --> 00:00:22,359
21. utils.selectEnvironment(ENV)

15
00:00:22,361 --> 00:00:22,626
25. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

16
00:00:22,626 --> 00:00:22,634
29. for ([TestScenarioNumber = 0, TestScenarioNumber < testdata.size(), (TestScenarioNumber++)])

17
00:00:22,637 --> 00:00:22,641
1. println(testdata.size())

18
00:00:22,641 --> 00:00:55,136
5. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

19
00:00:55,137 --> 00:00:55,142
9. println(getBookingData["BookingId"])

20
00:00:55,142 --> 00:00:55,145
13. println(getBookingData["BookingAccessToken"])

21
00:00:55,146 --> 00:01:00,152
17. delay(5)

22
00:01:00,153 --> 00:01:00,157
21. bookingIdCol = testdata["bookingId"][TestScenarioNumber]

23
00:01:00,157 --> 00:01:00,160
25. BookingId = getBookingData["BookingId"]

24
00:01:00,161 --> 00:01:00,166
29. replaceBookingId = bookingIdCol.replace("BookingId", BookingId)

25
00:01:00,167 --> 00:01:00,170
33. println(replaceBookingId)

26
00:01:00,170 --> 00:01:00,174
37. passengerIdCol = testdata["passengerId"][TestScenarioNumber]

27
00:01:00,174 --> 00:01:00,177
41. PassengerId = getBookingData["PassengerId"]

28
00:01:00,178 --> 00:01:00,219
45. replacePassengerId = passengerIdCol.replace("PassengerId", PassengerId)

29
00:01:00,219 --> 00:01:00,278
2. println(An unexpected error occurred: $e.message)

30
00:01:00,279 --> 00:01:00,284
6. e.printStackTrace()

31
00:01:00,284 --> 00:01:02,540
1. utils.closeBrowser()

