1
00:00:00,815 --> 00:00:00,818
1. try

2
00:00:00,819 --> 00:00:12,082
1. utils.openBrowserAndNavigateToPMT()

3
00:00:12,105 --> 00:00:12,108
5. EXCEL_PATH = "./Data Files/TestData.xlsx"

4
00:00:12,110 --> 00:00:12,112
9. TAB = "Wallet_Delete"

5
00:00:12,113 --> 00:00:12,117
13. driver = getWebDriver()

6
00:00:12,118 --> 00:00:13,737
17. utils.goToWallets()

7
00:00:13,738 --> 00:00:14,276
21. clickAuthorizePayment = xpath("//a[normalize-space()='Delete']")).click()

8
00:00:14,277 --> 00:00:15,037
25. utils.selectEnvironment(ENV)

9
00:00:15,040 --> 00:00:15,290
29. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

10
00:00:15,291 --> 00:00:15,765
33. fetchGuestAccount = sendRequest(findTestObject("GuestAccount"))

11
00:00:15,766 --> 00:00:15,809
37. accountId = getElementPropertyValue(fetchGuestAccount, "payload.accountId")

12
00:00:15,810 --> 00:00:15,865
41. accessToken = getElementPropertyValue(fetchGuestAccount, "payload.accessToken")

13
00:00:15,866 --> 00:00:15,870
45. accountId = accountId

14
00:00:15,871 --> 00:00:15,873
49. accessToken = accessToken

15
00:00:15,874 --> 00:00:16,001
53. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

16
00:00:16,002 --> 00:00:16,005
57. for ([i = 0, i < testdata.size(), (i++)])

17
00:00:16,005 --> 00:00:16,060
1. sendRequestTextBox.clear()

18
00:00:16,061 --> 00:00:16,064
5. cardNumber = testdata["cardNumber"][i]

19
00:00:16,065 --> 00:00:16,068
9. CNumber = cardNumber.replaceAll("\.0$", "")

20
00:00:16,068 --> 00:00:16,071
13. expirationMonth = testdata["expirationMonth"][i]

21
00:00:16,072 --> 00:00:16,075
17. xMonth = expirationMonth.replaceAll("\.0$", "")

22
00:00:16,075 --> 00:00:16,079
21. expirationYear = testdata["expirationYear"][i]

23
00:00:16,080 --> 00:00:16,085
25. xYear = expirationYear.replaceAll("\.0$", "")

24
00:00:16,085 --> 00:00:16,089
29. request = {
		"cardNumber": "$cardNumber",
		"expirationMonth": "$expirationMonth",
		"expirationYear": "$expirationYear",
		"accessToken": "$accountId",
		"accountId": "$accessToken"
		}

25
00:00:16,090 --> 00:00:16,093
33. restRequest = JsonSlurper().parseText(request)

26
00:00:16,093 --> 00:00:16,098
37. prettyJson = JsonBuilder(restRequest).toPrettyString()

27
00:00:16,099 --> 00:00:16,101
41. println(prettyJson)

28
00:00:16,102 --> 00:00:18,644
45. sendRequestTextBox.sendKeys(prettyJson)

29
00:00:18,645 --> 00:00:18,953
49. utils.clickSendButton()

30
00:00:18,954 --> 00:00:21,965
53. delay(3)

31
00:00:21,966 --> 00:00:24,046
57. response = utils.getResponse()

32
00:00:24,047 --> 00:00:24,050
61. println(response)

33
00:00:24,051 --> 00:00:24,055
65. validation1 = testdata["ContainsValidation"][i]

34
00:00:24,055 --> 00:00:24,058
69. println(validation1)

35
00:00:24,059 --> 00:00:24,062
73. validation2 = testdata["NotContainsValidation"][i]

36
00:00:24,062 --> 00:00:24,065
77. println(validation2)

37
00:00:24,066 --> 00:00:24,071
81. println(testdata["TCNumber"][i])

38
00:00:24,071 --> 00:00:24,076
85. assert response.contains(validation1)

39
00:00:24,077 --> 00:00:25,992
2. takeScreenshot("/screenshots/Failed_Wallet_Delete.png")

40
00:00:25,993 --> 00:00:28,276
1. utils.closeBrowser()

