1
00:00:00,343 --> 00:00:00,345
1. try

2
00:00:00,346 --> 00:00:06,143
1. utils.openBrowserAndNavigateToPMT()

3
00:00:06,180 --> 00:00:06,203
5. driver = getWebDriver()

4
00:00:06,222 --> 00:00:06,225
9. EXCEL_PATH = "./Data Files/TestData.xlsx"

5
00:00:06,226 --> 00:00:06,229
13. TAB = "ScheduledPayment_Get"

6
00:00:06,229 --> 00:00:09,772
17. utils.goToScheduledPayments()

7
00:00:09,773 --> 00:00:10,837
21. utils.selectEnvironment(ENV)

8
00:00:10,838 --> 00:00:10,888
25. testdataFromExcel = getdata.fromExcel(EXCEL_PATH, TAB)

9
00:00:10,888 --> 00:00:10,890
29. for ([TestScenarioNumber = 0, TestScenarioNumber < testdataFromExcel.size(), (TestScenarioNumber++)])

10
00:00:10,891 --> 00:00:10,893
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

11
00:00:10,894 --> 00:00:10,896
5. if (TestScenarioRequiresCreateBooking == "Yes")

12
00:00:10,896 --> 00:00:11,220
1. clickADD = xpath("//a[normalize-space()='Add']")).click()

13
00:00:11,220 --> 00:00:12,065
5. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

14
00:00:12,138 --> 00:00:12,230
9. sendRequestTextBox.clear()

15
00:00:12,234 --> 00:00:32,787
13. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

16
00:00:32,787 --> 00:00:32,789
17. println(getBookingData["BookingId"])

17
00:00:32,789 --> 00:00:32,790
21. println(getBookingData["BookingAccessToken"])

18
00:00:32,791 --> 00:00:37,795
25. delay(5)

19
00:00:37,796 --> 00:00:37,797
29. ADDRequestRaw = testdataFromExcel["ADDRequest"][TestScenarioNumber]

20
00:00:37,798 --> 00:00:37,799
33. BookingId = getBookingData["BookingId"]

21
00:00:37,799 --> 00:00:37,801
37. ADDRequest = ADDRequestRaw.replace("BookingId", BookingId)

22
00:00:37,801 --> 00:00:38,574
41. sendRequestTextBox.sendKeys(ADDRequest)

23
00:00:38,574 --> 00:00:38,577
45. println(ADDRequest)

24
00:00:38,577 --> 00:00:38,876
49. utils.clickSendButton()

25
00:00:38,877 --> 00:00:43,885
53. delay(5)

26
00:00:43,886 --> 00:00:45,273
57. refresh()

27
00:00:45,274 --> 00:00:48,279
61. delay(3)

28
00:00:48,280 --> 00:00:48,559
65. clickGET = xpath("//a[normalize-space()='Get']")).click()

29
00:00:48,560 --> 00:00:49,301
69. sendRequestTextBox2 = driver.findElement(By.xpath("//textarea[@name='req']"))

30
00:00:49,302 --> 00:00:49,330
73. sendRequestTextBox2.clear()

31
00:00:49,330 --> 00:00:49,332
77. BookingIdToBePassedRaw = testdataFromExcel["BookingId"][TestScenarioNumber]

32
00:00:49,332 --> 00:00:49,333
81. BookingIdToBePassed = BookingIdToBePassedRaw.replace("BookingId", BookingId)

33
00:00:49,334 --> 00:00:49,397
85. sendRequestTextBox2.sendKeys(BookingIdToBePassed)

34
00:00:49,398 --> 00:00:49,400
89. println(BookingIdToBePassed)

35
00:00:49,401 --> 00:00:49,684
93. utils.clickSendButton()

36
00:00:49,685 --> 00:00:54,690
97. delay(5)

37
00:00:54,690 --> 00:00:54,694
101. cancelBookingRequest = findTestObject("CancelBooking")

38
00:00:54,694 --> 00:00:55,563
105. cancelBookingResponse = sendRequest(cancelBookingRequest)

39
00:00:55,563 --> 00:00:55,565
109. cancelBookingJsonResponse = JsonSlurper().parseText(cancelBookingResponse.getResponseText())

40
00:00:55,565 --> 00:00:55,566
113. println(cancelBookingJsonResponse)

41
00:00:55,566 --> 00:00:55,797
117. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

42
00:00:55,798 --> 00:00:55,826
121. response = responseTextBox.getText()

43
00:00:55,826 --> 00:00:55,828
125. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

44
00:00:55,828 --> 00:00:55,830
129. assert response.contains(validationString)

45
00:00:55,830 --> 00:00:55,841
133. println("Test Scenario Number: " + TestScenarioNumber + 1)

46
00:00:55,842 --> 00:00:55,842
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

47
00:00:55,843 --> 00:00:55,843
5. if (TestScenarioRequiresCreateBooking == "Yes")

48
00:00:55,844 --> 00:00:56,149
1. clickADD = xpath("//a[normalize-space()='Add']")).click()

49
00:00:56,149 --> 00:00:56,781
5. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

50
00:00:56,781 --> 00:00:56,814
9. sendRequestTextBox.clear()

51
00:00:56,814 --> 00:01:17,421
13. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

52
00:01:17,422 --> 00:01:17,423
17. println(getBookingData["BookingId"])

53
00:01:17,423 --> 00:01:17,424
21. println(getBookingData["BookingAccessToken"])

54
00:01:17,424 --> 00:01:22,430
25. delay(5)

55
00:01:22,431 --> 00:01:22,431
29. ADDRequestRaw = testdataFromExcel["ADDRequest"][TestScenarioNumber]

56
00:01:22,432 --> 00:01:22,432
33. BookingId = getBookingData["BookingId"]

57
00:01:22,432 --> 00:01:22,433
37. ADDRequest = ADDRequestRaw.replace("BookingId", BookingId)

58
00:01:22,433 --> 00:01:23,222
41. sendRequestTextBox.sendKeys(ADDRequest)

59
00:01:23,226 --> 00:01:23,227
45. println(ADDRequest)

60
00:01:23,227 --> 00:01:24,732
49. utils.clickSendButton()

61
00:01:24,732 --> 00:01:29,739
53. delay(5)

62
00:01:29,739 --> 00:01:31,727
57. refresh()

63
00:01:31,728 --> 00:01:34,733
61. delay(3)

64
00:01:34,734 --> 00:01:35,015
65. clickGET = xpath("//a[normalize-space()='Get']")).click()

65
00:01:35,016 --> 00:01:35,651
69. sendRequestTextBox2 = driver.findElement(By.xpath("//textarea[@name='req']"))

66
00:01:35,651 --> 00:01:35,683
73. sendRequestTextBox2.clear()

67
00:01:35,684 --> 00:01:35,684
77. BookingIdToBePassedRaw = testdataFromExcel["BookingId"][TestScenarioNumber]

68
00:01:35,684 --> 00:01:35,685
81. BookingIdToBePassed = BookingIdToBePassedRaw.replace("BookingId", BookingId)

69
00:01:35,685 --> 00:01:35,777
85. sendRequestTextBox2.sendKeys(BookingIdToBePassed)

70
00:01:35,778 --> 00:01:35,780
89. println(BookingIdToBePassed)

71
00:01:35,780 --> 00:01:36,077
93. utils.clickSendButton()

72
00:01:36,078 --> 00:01:41,082
97. delay(5)

73
00:01:41,082 --> 00:01:41,085
101. cancelBookingRequest = findTestObject("CancelBooking")

74
00:01:41,086 --> 00:01:41,841
105. cancelBookingResponse = sendRequest(cancelBookingRequest)

75
00:01:41,842 --> 00:01:41,843
109. cancelBookingJsonResponse = JsonSlurper().parseText(cancelBookingResponse.getResponseText())

76
00:01:41,843 --> 00:01:41,845
113. println(cancelBookingJsonResponse)

77
00:01:41,845 --> 00:01:42,085
117. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

78
00:01:42,085 --> 00:01:42,103
121. response = responseTextBox.getText()

79
00:01:42,104 --> 00:01:42,105
125. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

80
00:01:42,105 --> 00:01:42,106
129. assert response.contains(validationString)

81
00:01:42,107 --> 00:01:42,108
133. println("Test Scenario Number: " + TestScenarioNumber + 1)

82
00:01:42,108 --> 00:01:42,109
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

83
00:01:42,110 --> 00:01:42,112
5. if (TestScenarioRequiresCreateBooking == "Yes")

84
00:01:42,112 --> 00:01:42,429
2. clickGET = xpath("//a[normalize-space()='Get']")).click()

85
00:01:42,444 --> 00:01:43,200
6. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

86
00:01:43,200 --> 00:01:43,427
10. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

87
00:01:43,427 --> 00:01:43,480
14. sendRequestTextBox.clear()

88
00:01:43,480 --> 00:01:43,482
18. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

89
00:01:43,482 --> 00:01:43,573
22. sendRequestTextBox.sendKeys(BookingIdToBePassed)

90
00:01:43,573 --> 00:01:43,575
26. println(BookingIdToBePassed)

91
00:01:43,575 --> 00:01:43,873
30. utils.clickSendButton()

92
00:01:43,873 --> 00:01:45,877
34. delay(2)

93
00:01:45,877 --> 00:01:45,889
38. response = responseTextBox.getText()

94
00:01:45,889 --> 00:01:45,890
42. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

95
00:01:45,891 --> 00:01:45,892
46. assert response.contains(validationString)

96
00:01:45,893 --> 00:01:45,894
50. println("Test Scenario Number: " + TestScenarioNumber + 1)

97
00:01:45,894 --> 00:01:45,895
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

98
00:01:45,895 --> 00:01:45,896
5. if (TestScenarioRequiresCreateBooking == "Yes")

99
00:01:45,896 --> 00:01:46,164
2. clickGET = xpath("//a[normalize-space()='Get']")).click()

100
00:01:46,164 --> 00:01:46,795
6. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

101
00:01:46,795 --> 00:01:47,018
10. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

102
00:01:47,018 --> 00:01:47,075
14. sendRequestTextBox.clear()

103
00:01:47,076 --> 00:01:47,077
18. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

104
00:01:47,077 --> 00:01:47,232
22. sendRequestTextBox.sendKeys(BookingIdToBePassed)

105
00:01:47,233 --> 00:01:47,234
26. println(BookingIdToBePassed)

106
00:01:47,234 --> 00:01:47,538
30. utils.clickSendButton()

107
00:01:47,539 --> 00:01:49,542
34. delay(2)

108
00:01:49,542 --> 00:01:49,552
38. response = responseTextBox.getText()

109
00:01:49,553 --> 00:01:49,553
42. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

110
00:01:49,554 --> 00:01:49,555
46. assert response.contains(validationString)

111
00:01:49,555 --> 00:01:49,556
50. println("Test Scenario Number: " + TestScenarioNumber + 1)

112
00:01:49,556 --> 00:01:49,557
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

113
00:01:49,558 --> 00:01:49,559
5. if (TestScenarioRequiresCreateBooking == "Yes")

114
00:01:49,559 --> 00:01:49,844
2. clickGET = xpath("//a[normalize-space()='Get']")).click()

115
00:01:49,844 --> 00:01:50,470
6. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

116
00:01:50,471 --> 00:01:50,695
10. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

117
00:01:50,696 --> 00:01:50,742
14. sendRequestTextBox.clear()

118
00:01:50,743 --> 00:01:50,744
18. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

119
00:01:50,744 --> 00:01:50,851
22. sendRequestTextBox.sendKeys(BookingIdToBePassed)

120
00:01:50,851 --> 00:01:50,852
26. println(BookingIdToBePassed)

121
00:01:50,852 --> 00:01:51,144
30. utils.clickSendButton()

122
00:01:51,144 --> 00:01:53,151
34. delay(2)

123
00:01:53,152 --> 00:01:53,162
38. response = responseTextBox.getText()

124
00:01:53,163 --> 00:01:53,163
42. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

125
00:01:53,163 --> 00:01:53,164
46. assert response.contains(validationString)

126
00:01:53,164 --> 00:01:53,164
50. println("Test Scenario Number: " + TestScenarioNumber + 1)

127
00:01:53,165 --> 00:01:53,165
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

128
00:01:53,165 --> 00:01:53,166
5. if (TestScenarioRequiresCreateBooking == "Yes")

129
00:01:53,167 --> 00:01:53,434
2. clickGET = xpath("//a[normalize-space()='Get']")).click()

130
00:01:53,434 --> 00:01:54,164
6. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

131
00:01:54,165 --> 00:01:54,388
10. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

132
00:01:54,388 --> 00:01:54,444
14. sendRequestTextBox.clear()

133
00:01:54,445 --> 00:01:54,446
18. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

134
00:01:54,446 --> 00:01:54,539
22. sendRequestTextBox.sendKeys(BookingIdToBePassed)

135
00:01:54,540 --> 00:01:54,541
26. println(BookingIdToBePassed)

136
00:01:54,541 --> 00:01:54,830
30. utils.clickSendButton()

137
00:01:54,830 --> 00:01:56,835
34. delay(2)

138
00:01:56,836 --> 00:01:56,845
38. response = responseTextBox.getText()

139
00:01:56,845 --> 00:01:56,846
42. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

140
00:01:56,846 --> 00:01:56,847
46. assert response.contains(validationString)

141
00:01:56,847 --> 00:01:56,848
50. println("Test Scenario Number: " + TestScenarioNumber + 1)

142
00:01:56,848 --> 00:01:56,849
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

143
00:01:56,849 --> 00:01:56,850
5. if (TestScenarioRequiresCreateBooking == "Yes")

144
00:01:56,850 --> 00:01:57,120
2. clickGET = xpath("//a[normalize-space()='Get']")).click()

145
00:01:57,121 --> 00:01:57,770
6. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

146
00:01:57,770 --> 00:01:57,994
10. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

147
00:01:57,995 --> 00:01:58,044
14. sendRequestTextBox.clear()

148
00:01:58,045 --> 00:01:58,045
18. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

149
00:01:58,046 --> 00:01:58,140
22. sendRequestTextBox.sendKeys(BookingIdToBePassed)

150
00:01:58,140 --> 00:01:58,141
26. println(BookingIdToBePassed)

151
00:01:58,141 --> 00:01:58,437
30. utils.clickSendButton()

152
00:01:58,438 --> 00:02:00,445
34. delay(2)

153
00:02:00,445 --> 00:02:00,456
38. response = responseTextBox.getText()

154
00:02:00,456 --> 00:02:00,457
42. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

155
00:02:00,457 --> 00:02:00,458
46. assert response.contains(validationString)

156
00:02:00,458 --> 00:02:00,459
50. println("Test Scenario Number: " + TestScenarioNumber + 1)

157
00:02:00,459 --> 00:02:00,460
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

158
00:02:00,460 --> 00:02:00,461
5. if (TestScenarioRequiresCreateBooking == "Yes")

159
00:02:00,462 --> 00:02:00,745
2. clickGET = xpath("//a[normalize-space()='Get']")).click()

160
00:02:00,746 --> 00:02:01,681
6. sendRequestTextBox = driver.findElement(By.xpath("//textarea[@name='req']"))

161
00:02:01,681 --> 00:02:01,907
10. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

162
00:02:01,908 --> 00:02:01,956
14. sendRequestTextBox.clear()

163
00:02:01,957 --> 00:02:01,978
18. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

164
00:02:01,978 --> 00:02:02,065
22. sendRequestTextBox.sendKeys(BookingIdToBePassed)

165
00:02:02,065 --> 00:02:02,066
26. println(BookingIdToBePassed)

166
00:02:02,066 --> 00:02:02,372
30. utils.clickSendButton()

167
00:02:02,379 --> 00:02:04,402
34. delay(2)

168
00:02:04,403 --> 00:02:04,413
38. response = responseTextBox.getText()

169
00:02:04,413 --> 00:02:04,413
42. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

170
00:02:04,414 --> 00:02:04,414
46. assert response.contains(validationString)

171
00:02:04,415 --> 00:02:04,416
50. println("Test Scenario Number: " + TestScenarioNumber + 1)

172
00:02:04,417 --> 00:02:06,628
1. utils.closeBrowser()

