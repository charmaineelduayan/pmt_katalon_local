1
00:00:01,283 --> 00:00:28,387
1. utils.openBrowserAndNavigateToPMT()

2
00:00:28,388 --> 00:00:28,394
5. try

3
00:00:28,395 --> 00:00:28,547
1. callTestCase(findTestCase("Re-Usable Script/Payment_AuthorizePayment"), [:], STOP_ON_FAILURE)

4
00:00:28,548 --> 00:00:28,553
1. driver = getWebDriver()

5
00:00:28,555 --> 00:00:30,200
5. utils.goToPayments()

6
00:00:30,203 --> 00:00:30,804
9. clickAuthorizePayment = xpath("//a[normalize-space()='Authorize payment']")).click()

7
00:00:30,805 --> 00:00:30,809
13. EXCEL_PATH = "./Data Files/TestData.xlsx"

8
00:00:30,813 --> 00:00:30,818
17. TAB = "Payment_Authorize"

9
00:00:30,819 --> 00:00:31,779
21. utils.selectEnvironment(ENV)

10
00:00:31,780 --> 00:00:31,913
25. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

11
00:00:31,921 --> 00:00:31,923
29. for ([TestScenarioNumber = 0, TestScenarioNumber < testdata.size(), (TestScenarioNumber++)])

12
00:00:31,924 --> 00:00:31,925
1. println(testdata.size())

13
00:00:31,926 --> 00:00:53,545
5. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

14
00:00:53,547 --> 00:00:53,552
9. println(getBookingData["BookingId"])

15
00:00:53,553 --> 00:00:53,558
13. println(getBookingData["BookingAccessToken"])

16
00:00:53,560 --> 00:00:58,572
17. delay(5)

17
00:00:58,573 --> 00:00:58,578
21. bookingIdCol = testdata["bookingId"][TestScenarioNumber]

18
00:00:58,578 --> 00:00:58,583
25. BookingId = getBookingData["BookingId"]

19
00:00:58,587 --> 00:00:58,593
29. replaceBookingId = bookingIdCol.replace("BookingId", BookingId)

20
00:00:58,594 --> 00:00:58,599
33. println(replaceBookingId)

21
00:00:58,600 --> 00:00:58,605
37. passengerIdCol = testdata["passengerId"][TestScenarioNumber]

22
00:00:58,606 --> 00:00:58,611
41. PassengerId = getBookingData["PassengerId"]

23
00:00:58,611 --> 00:00:58,640
45. replacePassengerId = passengerIdCol.replace("PassengerId", PassengerId)

24
00:00:58,641 --> 00:00:58,644
2. println(An unexpected error occurred: $e.message)

25
00:00:58,645 --> 00:00:58,652
6. e.printStackTrace()

26
00:00:58,652 --> 00:01:00,910
1. utils.closeBrowser()

