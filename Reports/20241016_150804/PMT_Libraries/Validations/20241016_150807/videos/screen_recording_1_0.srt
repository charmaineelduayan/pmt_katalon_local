1
00:00:01,507 --> 00:00:01,526
1. try

2
00:00:01,537 --> 00:00:20,770
1. utils.openBrowserAndNavigateToPMT()

3
00:00:20,790 --> 00:00:20,828
5. driver = getWebDriver()

4
00:00:20,829 --> 00:00:20,833
9. EXCEL_PATH = "./Data Files/TestData.xlsx"

5
00:00:20,833 --> 00:00:20,837
13. TAB = "Validations_Prevalidations&Conf"

6
00:00:20,838 --> 00:00:25,808
17. utils.goToValidations()

7
00:00:25,809 --> 00:00:27,213
21. utils.selectEnvironment(ENV)

8
00:00:27,214 --> 00:00:29,316
25. testdataFromExcel = getdata.fromExcel(EXCEL_PATH, TAB)

9
00:00:29,349 --> 00:00:29,648
29. clickAuthorizePayment = xpath("//a[normalize-space()='Prevalidations and Conf']")).click()

10
00:00:29,648 --> 00:00:29,653
33. for ([TestScenarioNumber = 0, TestScenarioNumber < testdataFromExcel.size(), (TestScenarioNumber++)])

11
00:00:29,654 --> 00:00:29,658
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

12
00:00:29,659 --> 00:00:29,663
5. if (TestScenarioRequiresCreateBooking == "Yes")

13
00:00:29,663 --> 00:00:30,205
1. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

14
00:00:30,298 --> 00:00:30,558
5. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

15
00:00:30,559 --> 00:00:30,604
9. sendRequestTextBox.clear()

16
00:00:30,605 --> 00:00:35,637
13. delay(5)

17
00:00:35,638 --> 00:01:06,822
17. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

18
00:01:06,845 --> 00:01:06,856
21. println(getBookingData["BookingId"])

19
00:01:06,858 --> 00:01:06,865
25. println(getBookingData["BookingAccessToken"])

20
00:01:06,866 --> 00:01:06,873
29. BookingId = getBookingData["BookingId"]

21
00:01:06,874 --> 00:01:06,883
33. BookingIdToBePassedRaw = testdataFromExcel["BookingId"][TestScenarioNumber]

22
00:01:06,884 --> 00:01:06,895
37. BookingIdToBePassed = BookingIdToBePassedRaw.replace("BookingId", BookingId)

23
00:01:06,896 --> 00:01:07,161
41. sendRequestTextBox.sendKeys(BookingIdToBePassed)

24
00:01:07,162 --> 00:01:07,172
45. println(BookingIdToBePassed)

25
00:01:07,174 --> 00:01:07,621
49. utils.clickSendButton()

26
00:01:07,622 --> 00:01:12,668
53. delay(5)

27
00:01:12,670 --> 00:01:12,935
57. cancelBookingRequest = findTestObject("CancelBooking")

28
00:01:12,936 --> 00:01:15,008
61. cancelBookingResponse = sendRequest(cancelBookingRequest)

29
00:01:15,010 --> 00:01:15,017
65. cancelBookingJsonResponse = JsonSlurper().parseText(cancelBookingResponse.getResponseText())

30
00:01:15,018 --> 00:01:15,025
69. println(cancelBookingJsonResponse)

31
00:01:15,026 --> 00:01:15,084
73. response = responseTextBox.getText()

32
00:01:15,086 --> 00:01:15,094
77. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

33
00:01:15,095 --> 00:01:15,107
81. assert response.contains(validationString)

34
00:01:15,110 --> 00:01:15,130
85. println("Test Scenario Number: " + TestScenarioNumber + 1)

35
00:01:15,132 --> 00:01:27,513
89. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

36
00:01:27,514 --> 00:01:27,518
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

37
00:01:27,519 --> 00:01:27,522
5. if (TestScenarioRequiresCreateBooking == "Yes")

38
00:01:27,523 --> 00:01:27,794
1. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

39
00:01:27,795 --> 00:01:28,057
5. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

40
00:01:28,058 --> 00:01:28,141
9. sendRequestTextBox.clear()

41
00:01:28,142 --> 00:01:33,151
13. delay(5)

42
00:01:33,153 --> 00:01:57,335
17. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

43
00:01:57,336 --> 00:01:57,337
21. println(getBookingData["BookingId"])

44
00:01:57,338 --> 00:01:57,340
25. println(getBookingData["BookingAccessToken"])

45
00:01:57,341 --> 00:01:57,343
29. BookingId = getBookingData["BookingId"]

46
00:01:57,349 --> 00:01:57,352
33. BookingIdToBePassedRaw = testdataFromExcel["BookingId"][TestScenarioNumber]

47
00:01:57,353 --> 00:01:57,356
37. BookingIdToBePassed = BookingIdToBePassedRaw.replace("BookingId", BookingId)

48
00:01:57,357 --> 00:01:57,529
41. sendRequestTextBox.sendKeys(BookingIdToBePassed)

49
00:01:57,530 --> 00:01:57,532
45. println(BookingIdToBePassed)

50
00:01:57,533 --> 00:01:57,841
49. utils.clickSendButton()

51
00:01:57,842 --> 00:02:02,867
53. delay(5)

52
00:02:02,888 --> 00:02:02,937
57. cancelBookingRequest = findTestObject("CancelBooking")

53
00:02:02,951 --> 00:02:05,430
61. cancelBookingResponse = sendRequest(cancelBookingRequest)

54
00:02:05,545 --> 00:02:05,588
65. cancelBookingJsonResponse = JsonSlurper().parseText(cancelBookingResponse.getResponseText())

55
00:02:05,629 --> 00:02:05,672
69. println(cancelBookingJsonResponse)

56
00:02:05,728 --> 00:02:05,749
73. response = responseTextBox.getText()

57
00:02:05,750 --> 00:02:05,751
77. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

58
00:02:05,752 --> 00:02:05,754
81. assert response.contains(validationString)

59
00:02:05,754 --> 00:02:05,756
85. println("Test Scenario Number: " + TestScenarioNumber + 1)

60
00:02:05,757 --> 00:02:09,390
89. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

61
00:02:09,412 --> 00:02:09,434
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

62
00:02:09,435 --> 00:02:09,438
5. if (TestScenarioRequiresCreateBooking == "Yes")

63
00:02:09,439 --> 00:02:09,677
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

64
00:02:09,678 --> 00:02:09,916
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

65
00:02:09,918 --> 00:02:09,985
10. sendRequestTextBox.clear()

66
00:02:10,004 --> 00:02:10,029
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

67
00:02:10,048 --> 00:02:10,162
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

68
00:02:10,169 --> 00:02:10,197
22. println(BookingIdToBePassed)

69
00:02:10,220 --> 00:02:10,528
26. utils.clickSendButton()

70
00:02:10,528 --> 00:02:12,569
30. delay(2)

71
00:02:12,630 --> 00:02:12,707
34. response = responseTextBox.getText()

72
00:02:12,752 --> 00:02:12,785
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

73
00:02:12,858 --> 00:02:12,918
42. assert response.contains(validationString)

74
00:02:12,974 --> 00:02:13,041
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

75
00:02:13,095 --> 00:02:17,863
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

76
00:02:17,864 --> 00:02:17,866
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

77
00:02:17,866 --> 00:02:17,870
5. if (TestScenarioRequiresCreateBooking == "Yes")

78
00:02:17,871 --> 00:02:18,107
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

79
00:02:18,108 --> 00:02:18,349
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

80
00:02:18,350 --> 00:02:18,399
10. sendRequestTextBox.clear()

81
00:02:18,400 --> 00:02:18,401
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

82
00:02:18,402 --> 00:02:18,473
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

83
00:02:18,474 --> 00:02:18,476
22. println(BookingIdToBePassed)

84
00:02:18,477 --> 00:02:18,783
26. utils.clickSendButton()

85
00:02:18,784 --> 00:02:20,791
30. delay(2)

86
00:02:20,811 --> 00:02:20,845
34. response = responseTextBox.getText()

87
00:02:20,853 --> 00:02:20,874
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

88
00:02:20,874 --> 00:02:20,876
42. assert response.contains(validationString)

89
00:02:20,877 --> 00:02:20,878
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

90
00:02:20,879 --> 00:02:23,904
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

91
00:02:23,907 --> 00:02:23,910
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

92
00:02:23,911 --> 00:02:23,914
5. if (TestScenarioRequiresCreateBooking == "Yes")

93
00:02:23,915 --> 00:02:24,152
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

94
00:02:24,153 --> 00:02:24,383
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

95
00:02:24,384 --> 00:02:24,427
10. sendRequestTextBox.clear()

96
00:02:24,428 --> 00:02:24,429
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

97
00:02:24,430 --> 00:02:24,510
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

98
00:02:24,510 --> 00:02:24,512
22. println(BookingIdToBePassed)

99
00:02:24,512 --> 00:02:24,811
26. utils.clickSendButton()

100
00:02:24,811 --> 00:02:26,820
30. delay(2)

101
00:02:26,861 --> 00:02:26,897
34. response = responseTextBox.getText()

102
00:02:26,906 --> 00:02:26,944
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

103
00:02:26,944 --> 00:02:26,966
42. assert response.contains(validationString)

104
00:02:26,967 --> 00:02:26,968
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

105
00:02:26,969 --> 00:02:30,025
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

106
00:02:30,026 --> 00:02:30,028
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

107
00:02:30,028 --> 00:02:30,030
5. if (TestScenarioRequiresCreateBooking == "Yes")

108
00:02:30,031 --> 00:02:30,264
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

109
00:02:30,264 --> 00:02:30,495
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

110
00:02:30,495 --> 00:02:30,536
10. sendRequestTextBox.clear()

111
00:02:30,536 --> 00:02:30,538
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

112
00:02:30,539 --> 00:02:30,615
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

113
00:02:30,615 --> 00:02:30,617
22. println(BookingIdToBePassed)

114
00:02:30,617 --> 00:02:30,918
26. utils.clickSendButton()

115
00:02:30,918 --> 00:02:32,927
30. delay(2)

116
00:02:32,927 --> 00:02:32,948
34. response = responseTextBox.getText()

117
00:02:32,949 --> 00:02:32,951
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

118
00:02:32,951 --> 00:02:32,953
42. assert response.contains(validationString)

119
00:02:32,955 --> 00:02:32,957
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

120
00:02:32,958 --> 00:02:36,079
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

121
00:02:36,080 --> 00:02:36,082
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

122
00:02:36,083 --> 00:02:36,086
5. if (TestScenarioRequiresCreateBooking == "Yes")

123
00:02:36,087 --> 00:02:36,323
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

124
00:02:36,324 --> 00:02:36,557
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

125
00:02:36,558 --> 00:02:36,604
10. sendRequestTextBox.clear()

126
00:02:36,605 --> 00:02:36,606
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

127
00:02:36,608 --> 00:02:36,697
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

128
00:02:36,700 --> 00:02:36,702
22. println(BookingIdToBePassed)

129
00:02:36,702 --> 00:02:37,056
26. utils.clickSendButton()

130
00:02:37,057 --> 00:02:39,083
30. delay(2)

131
00:02:39,104 --> 00:02:39,122
34. response = responseTextBox.getText()

132
00:02:39,123 --> 00:02:39,125
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

133
00:02:39,126 --> 00:02:39,148
42. assert response.contains(validationString)

134
00:02:39,148 --> 00:02:39,150
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

135
00:02:39,151 --> 00:02:42,732
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

136
00:02:42,733 --> 00:02:42,734
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

137
00:02:42,735 --> 00:02:42,738
5. if (TestScenarioRequiresCreateBooking == "Yes")

138
00:02:42,759 --> 00:02:42,997
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

139
00:02:42,998 --> 00:02:43,234
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

140
00:02:43,235 --> 00:02:43,280
10. sendRequestTextBox.clear()

141
00:02:43,280 --> 00:02:43,282
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

142
00:02:43,283 --> 00:02:43,367
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

143
00:02:43,368 --> 00:02:43,370
22. println(BookingIdToBePassed)

144
00:02:43,371 --> 00:02:43,675
26. utils.clickSendButton()

145
00:02:43,676 --> 00:02:45,684
30. delay(2)

146
00:02:45,686 --> 00:02:45,721
34. response = responseTextBox.getText()

147
00:02:45,728 --> 00:02:45,749
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

148
00:02:45,770 --> 00:02:45,772
42. assert response.contains(validationString)

149
00:02:45,795 --> 00:02:45,836
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

150
00:02:45,837 --> 00:02:48,816
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

151
00:02:48,817 --> 00:02:48,819
1. TestScenarioRequiresCreateBooking = testdataFromExcel["ExecuteBookingCreationFlag"][TestScenarioNumber]

152
00:02:48,820 --> 00:02:48,825
5. if (TestScenarioRequiresCreateBooking == "Yes")

153
00:02:48,826 --> 00:02:49,065
2. sendRequestTextBox = driver.findElement(By.xpath("//input[@id='1']"))

154
00:02:49,066 --> 00:02:49,301
6. responseTextBox = driver.findElement(By.xpath("/html[1]/body[1]/div[1]/main[1]/div[1]/section[1]/div[2]/div[1]/div[1]/div[2]/div[1]/div[1]/div[1]/form[1]/div[1]/div[1]/textarea[1]"))

155
00:02:49,301 --> 00:02:49,350
10. sendRequestTextBox.clear()

156
00:02:49,351 --> 00:02:49,352
14. BookingIdToBePassed = testdataFromExcel["BookingId"][TestScenarioNumber]

157
00:02:49,353 --> 00:02:49,437
18. sendRequestTextBox.sendKeys(BookingIdToBePassed)

158
00:02:49,438 --> 00:02:49,440
22. println(BookingIdToBePassed)

159
00:02:49,442 --> 00:02:49,751
26. utils.clickSendButton()

160
00:02:49,751 --> 00:02:51,757
30. delay(2)

161
00:02:51,758 --> 00:02:51,774
34. response = responseTextBox.getText()

162
00:02:51,774 --> 00:02:51,775
38. validationString = testdataFromExcel["Validation"][TestScenarioNumber]

163
00:02:51,776 --> 00:02:51,777
42. assert response.contains(validationString)

164
00:02:51,778 --> 00:02:51,779
46. println("Test Scenario Number: " + TestScenarioNumber + 1)

165
00:02:51,780 --> 00:02:54,952
50. takeFullPageScreenshotAsCheckpoint("Sample Visual Screenshot")

166
00:02:54,953 --> 00:02:57,224
1. utils.closeBrowser()

