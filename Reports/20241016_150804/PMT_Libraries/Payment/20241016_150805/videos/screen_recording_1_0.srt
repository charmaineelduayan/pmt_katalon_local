1
00:00:01,459 --> 00:00:14,384
1. utils.openBrowserAndNavigateToPMT()

2
00:00:14,421 --> 00:00:14,430
5. try

3
00:00:14,431 --> 00:00:14,436
1. EXCEL_PATH = "./Data Files/TestData.xlsx"

4
00:00:14,436 --> 00:00:14,441
5. TAB = "Payment_Capture"

5
00:00:14,442 --> 00:00:15,621
9. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

6
00:00:15,622 --> 00:00:15,628
13. for ([TestScenarioNumber = 0, TestScenarioNumber < testdata.size(), (TestScenarioNumber++)])

7
00:00:15,629 --> 00:00:15,637
1. println(testdata.size())

8
00:00:15,637 --> 00:00:16,379
5. callTestCase(findTestCase("Re-Usable Script/Payment_AuthorizePayment"), [:], STOP_ON_FAILURE)

9
00:00:16,380 --> 00:00:16,395
1. driver = getWebDriver()

10
00:00:16,396 --> 00:00:27,121
5. utils.goToPayments()

11
00:00:27,122 --> 00:00:27,823
9. clickAuthorizePayment = xpath("//a[normalize-space()='Authorize payment']")).click()

12
00:00:27,823 --> 00:00:27,827
13. EXCEL_PATH = "./Data Files/TestData.xlsx"

13
00:00:27,827 --> 00:00:27,831
17. TAB = "Payment_Authorize"

14
00:00:27,831 --> 00:00:29,228
21. utils.selectEnvironment(ENV)

15
00:00:29,229 --> 00:00:29,375
25. testdata = getdata.fromExcel(EXCEL_PATH, TAB)

16
00:00:29,394 --> 00:00:29,402
29. for ([TestScenarioNumber = 0, TestScenarioNumber < testdata.size(), (TestScenarioNumber++)])

17
00:00:29,403 --> 00:00:29,407
1. println(testdata.size())

18
00:00:29,407 --> 00:00:58,288
5. getBookingData = CreateAndRetrieveBooking.Data(EXCEL_PATH, TAB, TestScenarioNumber)

19
00:00:58,290 --> 00:00:58,296
9. println(getBookingData["BookingId"])

20
00:00:58,297 --> 00:00:58,302
13. println(getBookingData["BookingAccessToken"])

21
00:00:58,303 --> 00:01:03,319
17. delay(5)

22
00:01:03,320 --> 00:01:03,329
21. bookingIdCol = testdata["bookingId"][TestScenarioNumber]

23
00:01:03,331 --> 00:01:03,339
25. BookingId = getBookingData["BookingId"]

24
00:01:03,340 --> 00:01:03,352
29. replaceBookingId = bookingIdCol.replace("BookingId", BookingId)

25
00:01:03,353 --> 00:01:03,359
33. println(replaceBookingId)

26
00:01:03,360 --> 00:01:03,370
37. passengerIdCol = testdata["passengerId"][TestScenarioNumber]

27
00:01:03,371 --> 00:01:03,405
41. PassengerId = getBookingData["PassengerId"]

28
00:01:03,421 --> 00:01:03,669
45. replacePassengerId = passengerIdCol.replace("PassengerId", PassengerId)

29
00:01:03,670 --> 00:01:03,927
2. println(An unexpected error occurred: $e.message)

30
00:01:03,928 --> 00:01:03,953
6. e.printStackTrace()

31
00:01:03,954 --> 00:01:06,706
1. utils.closeBrowser()

